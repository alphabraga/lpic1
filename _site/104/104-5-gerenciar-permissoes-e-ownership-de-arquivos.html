<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>104.5 Gerenciar Permissões e Owership de Arquivos (Peso 3)</title>
  <meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
">

  <link rel="stylesheet" href="/lpic1/css/main.css">
  <link rel="stylesheet" href="/lpic1/css/prism.css">
  <link rel="canonical" href="/lpic1/104/104-5-gerenciar-permissoes-e-ownership-de-arquivos">
  <link rel="alternate" type="application/rss+xml" title="Livro LPIC 101 - O Curso" href="/lpic1/feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/lpic1/">Livro LPIC 101 - O Curso</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/lpic1/indice/">Indice</a>
          
        
          
        
          
          <a class="page-link" href="/lpic1/inicio/">Inicio</a>
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">104.5 Gerenciar Permissões e Owership de Arquivos (Peso 3)</h1>
  </header>

  <div class="post-content">
    <p>Ter a capacidade de controlar acesso a arquivos e tambem e utilizar o controle de permissões ownerships de modo adequado.</p>

<ul>
  <li>Gerenciar acesso a permissões em arquivos regulares e especiais como tambem em diretórios</li>
  <li>Utilizar modos de acesso como o <code class="highlighter-rouge">sgid</code> e o <code class="highlighter-rouge">sticky bit</code> para manter a segurança</li>
  <li>Saber como mudar a mascara de criação de arquivos</li>
  <li>Utilizar o campo de grupo para garantir acesso a arquvios menbros de grupos</li>
</ul>

<h2 id="chmod">chmod</h2>

<p>O comando <code class="highlighter-rouge">chmod</code> segundo o <code class="highlighter-rouge">man</code> é:</p>

<blockquote>
  <p>chmod changes the file mode bits of each given file according to mode,
which can be either a symbolic representation of changes to make, 
or an octal number representing the bit pattern for the new
mode bits.</p>
</blockquote>

<p>Em resumo esse comando altera as pemissões de um arquivo ou diretório. Atraves de parametros utilizando <code class="highlighter-rouge">letras</code> que podemos chamar de simbolico e o octal.</p>

<h3 id="modo-octal">Modo Octal</h3>

<h3 id="modo-simbolico">Modo Simbolico</h3>

<p>Para visualizar as pemissões de um arquivo iremos executar o comando</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>ls -l arquivo.txt</code>
-rwxrwxrwx 1 alphabraga alphabraga 0 Abr 10 23:02 arquivo.txt
</pre>

<p>As permissões do arquivo <code class="highlighter-rouge">arquivo.txt</code> são representadas pelos caracteres <code class="highlighter-rouge">-rw-rw-r--</code> .</p>

<ul>
  <li><code class="highlighter-rouge">r</code> permissão de leitura (<strong>r</strong>ead)</li>
  <li><code class="highlighter-rouge">w</code> permissão de escrita (<strong>w</strong>rite)</li>
  <li><code class="highlighter-rouge">x</code> permissão de execução (e<strong>x</strong>ecution)</li>
</ul>

<p>Esses caracteres representam de forma simplificada 3 níveis de permissão:</p>

<ul>
  <li><strong>rwx</strong>rwxrwx permissões de usuário</li>
  <li>rwx<strong>rwx</strong>rwx permissões de grupo</li>
  <li>rwxrwx<strong>rwx</strong> permissões de outros</li>
</ul>

<p>Primeiro vamos remover todas as permissões do arquivo</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>sudo chmod 000 arquivo.txt</code>
</pre>

<p>Para atribuir ao dono do arquivo a permissão de leitura:</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>chmod u=r arquivo.txt</code> 
<code>ls -la arquivo.txt</code> 
-r-------- 1 alphabraga alphabraga 0 Abr 10 23:02 arquivo.txt
</pre>

<p>Para remover a permissão utilizamos o sinal de <code class="highlighter-rouge">-</code></p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>chmod u-r arquivo.txt</code> 
<code>ls -l arquivo.txt</code> 
---------- 1 alphabraga alphabraga 0 Abr 10 23:02 arquivo.txt
</pre>

<p>Podemos adicionar e remover varias permissões ao mesmo tempo</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>chmod u+rwx arquivo.txt</code> 
<code>ls -l arquivo.txt</code> 
-rwx------ 1 alphabraga alphabraga 0 Abr 10 23:02 arquivo.txt
</pre>

<p>Ou ainda assim para o dono:</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>chmod u=rwx arquivo.txt</code> 
<code>ls -l arquivo.txt</code> 
-rwx------ 1 alphabraga alphabraga 0 Abr 10 23:02 arquivo.txt
</pre>

<p>Para o grupo:</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>chmod g=rwx arquivo.txt</code> 
<code>ls -l arquivo.txt</code> 
----rwx--- 1 alphabraga alphabraga 0 Abr 10 23:02 arquivo.txt
</pre>

<p>Para os outros:</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>chmod o=rwx arquivo.txt</code> 
<code>ls -l arquivo.txt</code> 
-------rwx 1 alphabraga alphabraga 0 Abr 10 23:02 arquivo.txt
</pre>

<p>Dar permissão de execução para o dono, o grupo e os outros:</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>chmod +x arquivo.txt</code> 
<code>ls -l arquivo.txt</code> 
---x--x--x 1 alphabraga alphabraga 0 Abr 10 23:02 arquivo.txt
</pre>

<h3 id="r---recursive">-R, –recursive</h3>

<p>Realiza as alterações de forma recursiva</p>

<h2 id="chown">chown</h2>

<p>O comando <code class="highlighter-rouge">chown</code> (Change Owner) realiza a alteração do dono e do grupo do arquivo</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>ls -l arquivo.txt</code> 
---x--x--x 1 outro outrogrupo 0 Abr 10 23:02 arquivo.txt
<code>chown alphabraga arquivo.txt</code> 
<code>ls -l arquivo.txt</code> 
---x--x--x 1 alphabraga outrogrupo 0 Abr 10 23:02 arquivo.txt
</pre>

<p>Agora para mudar o grupo podemos fazer assim:</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>ls -l arquivo.txt</code> 
---x--x--x 1 outro outrogrupo 0 Abr 10 23:02 arquivo.txt
<code>chown alphabraga:alphabraga arquivo.txt</code> 
<code>ls -l arquivo.txt</code> 
---x--x--x 1 alphabraga alphabraga 0 Abr 10 23:02 arquivo.txt
</pre>

<p>Para mudar só o grupo</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>ls -l arquivo.txt</code> 
---x--x--x 1 outro outrogrupo 0 Abr 10 23:02 arquivo.txt
<code>chown :alphabraga arquivo.txt</code> 
<code>ls -l arquivo.txt</code> 
---x--x--x 1 outro alphabraga 0 Abr 10 23:02 arquivo.txt
</pre>

<p>Podemos usar o separador <code class="highlighter-rouge">.</code> para separar o usuario do grupo</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>ls -l arquivo.txt</code> 
---x--x--x 1 outro outrogrupo 0 Abr 10 23:02 arquivo.txt
<code>chown .alphabraga arquivo.txt</code> 
<code>ls -l arquivo.txt</code> 
---x--x--x 1 outro alphabraga 0 Abr 10 23:02 arquivo.txt
</pre>

<h3 id="r---recursive-1">-R, –recursive</h3>

<p>Com o  <code class="highlighter-rouge">-R</code> podemos aplicar as alterações de forma recursiva, para toda uma pasta por exemplo.</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>sudo chown -R root:root dir-perms </code> 
<code>ls -l dir-perms/*</code> 
-rw-rw-r-- 1 root root 0 Apr 12 14:09 dir-perms/exemplo-0.txt
-rw-rw-r-- 1 root root 0 Apr 12 14:09 dir-perms/exemplo-10.txt
-rw-rw-r-- 1 root root 0 Apr 12 14:09 dir-perms/exemplo-11.txt
-rw-rw-r-- 1 root root 0 Apr 12 14:09 dir-perms/exemplo-12.txt
-rw-rw-r-- 1 root root 0 Apr 12 14:09 dir-perms/exemplo-13.txt
-rw-rw-r-- 1 root root 0 Apr 12 14:09 dir-perms/exemplo-14.txt
-rw-rw-r-- 1 root root 0 Apr 12 14:09 dir-perms/exemplo-15.txt
-rw-rw-r-- 1 root root 0 Apr 12 14:09 dir-perms/exemplo-16.txt
</pre>

<h2 id="chgrp">chgrp</h2>

<p>Esse comando muda apenas o grupo do arquivo.</p>

<h2 id="umask">umask</h2>

<p>Sempre que o usuário realiza a criação de um arquivo ou diretorio no sistema operacional o mesmo os cria utilizando dois parametros. O primeiro é permissão padrão do elemento criado. Para arquivos a permissão padão é a <code class="highlighter-rouge">666</code>, já para diretorios é a <code class="highlighter-rouge">777</code>.</p>

<blockquote>
  <p>A permissão padrão para criar arquivos é 666 e para diretórios é 777</p>
</blockquote>

<p>O segundo parametro utilizado para a criação de arquivos e diretórios é a mascara padrão do sistema. A mascara padrão do sistema é um valor octal que sera subtraido do valor da permissão padrão. O comando <code class="highlighter-rouge">umask</code> retorna o valor da máscara.</p>

<p>Sendo assim a permissão de um arquivo em um sistema linux é igual a 666 - <code class="highlighter-rouge">umask</code>. E a permissão de um diretório é 777 - o <code class="highlighter-rouge">umask</code>.</p>

<p>Para saber o <code class="highlighter-rouge">umask</code> padrão do sistema iremos utilizar o comando umask.</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>umask</code> 
002
</pre>

<p>Admitindo que o umask é igual a <code class="highlighter-rouge">002</code>. A permissão final do arquivo será igual a <code class="highlighter-rouge">664</code>, ou seja, <code class="highlighter-rouge">rw-rw-r--</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>	666
-	002
	____
	664
</code></pre>
</div>

<p>Podemos comprovar isso dando criando e listando o arquivo recem criado.</p>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>touch minhas-perms.txt</code> 
<code>ls -l minhas-perms.txt</code> 
-rw-rw-r-- 1 alphabraga alphabraga 0 Apr 12 13:59 minhas-perms.txt
<code>stat minhas-perms.txt</code> 
  File: 'minhas-perms.txt'
  Size: 0         	Blocks: 0          IO Block: 4096   regular empty file
Device: 801h/2049d	Inode: 37506501    Links: 1
Access: (0664/-rw-rw-r--)  Uid: ( 1000/alphabraga)   Gid: ( 1000/alphabraga)
Access: 2018-04-12 13:59:02.778333875 -0300
Modify: 2018-04-12 13:59:02.778333875 -0300
Change: 2018-04-12 13:59:02.778333875 -0300
</pre>

<p>Da mesma forma que ao criar um diretorio a permissão final do diretório será <code class="highlighter-rouge">775</code> ou ainda <code class="highlighter-rouge">rwxrwxr-x</code></p>

<div class="highlighter-rouge"><pre class="highlight"><code>	777
-	002
	____
	775
</code></pre>
</div>

<pre class="command-line language-bash" data-user="alphabraga" data-host="localhost">
<code>mkdir dir-perms</code> 
<code>ls -l | grep dir-perms</code>
drwxrwxr-x  2 alphabraga alphabraga       4096 Apr 12 14:01 dir-perms
<code>stat dir-perms</code>
  File: 'dir-perms'
  Size: 4096      	Blocks: 8          IO Block: 4096   directory
Device: 801h/2049d	Inode: 45350989    Links: 2
Access: (0775/drwxrwxr-x)  Uid: ( 1000/alphabraga)   Gid: ( 1000/alphabraga)
Access: 2018-04-12 14:01:22.751563302 -0300
Modify: 2018-04-12 14:01:19.599535514 -0300
Change: 2018-04-12 14:01:19.599535514 -0300
 Birth: -
</pre>

  </div>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Livro LPIC 101 - O Curso</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Livro LPIC 101 - O Curso</li>
          <li><a href="mailto:alfredorodruguesbraga@gmail.com">alfredorodruguesbraga@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/alphabraga"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">alphabraga</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/alphabraga"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">alphabraga</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
</p>
      </div>
    </div>

  </div>

</footer>


  <script type="text/javascript" src="/lpic1/js/prism.js" ></script>  
  </body>

</html>
